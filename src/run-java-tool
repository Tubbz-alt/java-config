#!/bin/bash

if [[ -n ${GENTOO_VM} ]]; then
	vmpath=/etc/java-config/vms/${GENTOO_VM}/
elif [[ -h ${HOME}/.gentoo/user-vm ]]; then
	vmpath=${HOME}/.gentoo/user-vm/
else
	vmpath=/etc/java-config/vms/system-vm/
fi

bin=${vmpath}/bin/$(basename $0)

if [[ -x ${bin} ]]; then
	exec ${bin} "${@}"
else
	echo "Want too run ${bin} but it does not exist or is not executable" > /dev/stderr
	exit 1
fi
